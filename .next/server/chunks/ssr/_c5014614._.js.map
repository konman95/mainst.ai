{"version":3,"sources":["../../../../lib/api.ts","../../../../app/contacts/page.tsx"],"sourcesContent":["import { getAuth } from \"./auth\";\nconst BASE = process.env.NEXT_PUBLIC_API_BASE_URL || \"http://localhost:8000\";\nconst USE_MOCK = (process.env.NEXT_PUBLIC_USE_MOCK || \"false\") === \"true\";\n\nfunction isMockEnabled(): boolean {\n  if (typeof window !== \"undefined\") {\n    const runtime = localStorage.getItem(\"USE_MOCK\");\n    if (runtime === \"true\") return true;\n    if (runtime === \"false\") return false;\n  }\n  return USE_MOCK;\n}\n\nfunction buildUrl(path: string) {\n  if (isMockEnabled()) return `/api/mock${path}`;\n  return BASE + path;\n}\n\nasync function req(path: string, body?: any, method?: string) {\n  const auth = getAuth();\n  let res: Response;\n  try {\n    res = await fetch(buildUrl(path), {\n      method: method || (body ? \"POST\" : \"GET\"),\n      headers: {\n        \"Content-Type\": \"application/json\",\n        ...(auth ? { Authorization: `Bearer ${auth.token}` } : {})\n      },\n      body: body ? JSON.stringify(body) : undefined\n    });\n  } catch (e: any) {\n    throw new Error(\"Network error: \" + (e?.message || String(e)));\n  }\n\n  if (!res.ok) {\n    const text = await res.text().catch(() => `HTTP ${res.status}`);\n    throw new Error(text);\n  }\n\n  try {\n    return await res.json();\n  } catch (e) {\n    return null;\n  }\n}\n\nexport const api = {\n  health: () => req(\"/health\"),\n  chat: (b: any) => req(\"/chat\", b),\n  ownerGet: () => req(\"/ownercover/settings\"),\n  ownerSet: (b: any) => req(\"/ownercover/settings\", b),\n  ownerInbound: (b: any) => req(\"/ownercover/handleInbound\", b),\n  contacts: () => req(\"/contacts\"),\n  createContact: (b: any) => req(\"/contacts\", b, \"POST\"),\n  updateContact: (id: string, b: any) => req(`/contacts/${id}`, b, \"PUT\"),\n  deleteContact: (id: string) => req(`/contacts/${id}`, undefined, \"DELETE\")\n};\n","\"use client\";\nimport { useEffect, useState } from \"react\";\nimport { api } from \"../../lib/api\";\n\nexport default function Contacts() {\n  const [contacts,setContacts]=useState<any[] | null>(null);\n  const [error,setError]=useState<string | null>(null);\n  const [editing,setEditing]=useState<any | null>(null);\n  const [name,setName]=useState(\"\");\n  const [email,setEmail]=useState(\"\");\n\n  async function load() {\n    setError(null);\n    try {\n      const c = await api.contacts();\n      setContacts(c || []);\n    } catch (e: any) {\n      setError(e?.message || String(e));\n      setContacts(null);\n    }\n  }\n\n  useEffect(()=>{ load(); },[]);\n\n  function startNew() {\n    setEditing({});\n    setName(\"\");\n    setEmail(\"\");\n  }\n\n  function startEdit(c:any) {\n    setEditing(c);\n    setName(c.name || \"\");\n    setEmail(c.email || \"\");\n  }\n\n  async function save() {\n    try {\n      if (editing?.id) {\n        await api.updateContact(editing.id, { name, email });\n      } else {\n        await api.createContact({ name, email });\n      }\n      setEditing(null);\n      await load();\n    } catch (e:any) {\n      setError(e?.message || String(e));\n    }\n  }\n\n  async function remove(id:string) {\n    try {\n      await api.deleteContact(id);\n      await load();\n    } catch (e:any) {\n      setError(e?.message || String(e));\n    }\n  }\n\n  return (\n    <div>\n      <h2>Contacts</h2>\n      {error && <div className=\"muted\">Error: {error}</div>}\n\n      <div style={{marginBottom:12}}>\n        <button className=\"btn\" onClick={startNew}>New Contact</button>\n        <button className=\"btn\" onClick={load} style={{marginLeft:8}}>Reload</button>\n      </div>\n\n      {editing && (\n        <div style={{marginBottom:12}}>\n          <input className=\"input\" placeholder=\"Name\" value={name} onChange={e=>setName(e.target.value)} />\n          <input className=\"input\" placeholder=\"Email\" value={email} onChange={e=>setEmail(e.target.value)} />\n          <div className=\"row\" style={{marginTop:8}}>\n            <button className=\"btn primary\" onClick={save}>Save</button>\n            <button className=\"btn\" onClick={()=>setEditing(null)}>Cancel</button>\n          </div>\n        </div>\n      )}\n\n      {!contacts ? (\n        <div className=\"muted\">No contacts loaded.</div>\n      ) : (\n        <div>\n          {contacts.length === 0 && <div className=\"muted\">No contacts found.</div>}\n          <ul>\n            {contacts.map((c,i)=> (\n              <li key={c.id || i}>\n                <b>{c.name}</b> â€” <span className=\"muted\">{c.email}</span>\n                <div className=\"row\" style={{marginTop:6}}>\n                  <button className=\"btn\" onClick={()=>startEdit(c)}>Edit</button>\n                  <button className=\"btn\" onClick={()=>remove(c.id)} style={{marginLeft:8}}>Delete</button>\n                </div>\n              </li>\n            ))}\n          </ul>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}