{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/konnerwest/mainst1/mainstai/app/security/page.tsx"],"sourcesContent":["\"use client\";\nimport { useEffect, useState } from \"react\";\nimport { api } from \"../../lib/api\";\n\ntype Policy = {\n  id: string;\n  name: string;\n  description: string;\n  enabled: boolean;\n};\n\ntype LogEntry = {\n  id: string;\n  event: string;\n  status: \"resolved\" | \"monitoring\" | \"investigating\";\n  ts: string;\n};\n\nconst defaultPolicies: Policy[] = [\n  {\n    id: \"mfa\",\n    name: \"Multi-factor enforcement\",\n    description: \"Require MFA for owners and managers.\",\n    enabled: true\n  },\n  {\n    id: \"ip\",\n    name: \"IP allowlist\",\n    description: \"Restrict logins to trusted networks.\",\n    enabled: false\n  },\n  {\n    id: \"export\",\n    name: \"Weekly audit export\",\n    description: \"Send encrypted audit bundle to the owner.\",\n    enabled: true\n  },\n  {\n    id: \"retention\",\n    name: \"90-day data retention\",\n    description: \"Auto-archive conversations after 90 days.\",\n    enabled: false\n  }\n];\n\nconst defaultLogs: LogEntry[] = [\n  { id: \"log-1\", event: \"Action queue accessed\", status: \"resolved\", ts: \"Today 路 3:42 PM\" },\n  { id: \"log-2\", event: \"Guardrail update\", status: \"resolved\", ts: \"Today 路 2:58 PM\" },\n  { id: \"log-3\", event: \"Login from new device\", status: \"monitoring\", ts: \"Yesterday 路 8:11 PM\" }\n];\n\nexport default function Security() {\n  const [policies, setPolicies] = useState<Policy[]>(defaultPolicies);\n  const [logs, setLogs] = useState<LogEntry[]>(defaultLogs);\n  const [exporting, setExporting] = useState(false);\n  const [message, setMessage] = useState<string | null>(null);\n  const [role, setRole] = useState<\"Owner\" | \"Manager\" | \"Agent\">(\"Owner\");\n\n  useEffect(() => {\n    api.securityPolicies()\n      .then((data) => setPolicies(data || defaultPolicies))\n      .catch(() => setPolicies(defaultPolicies));\n    api.securityLogs()\n      .then((data) => setLogs(data || defaultLogs))\n      .catch(() => setLogs(defaultLogs));\n    api.accessGet()\n      .then((data) => setRole(data?.role || \"Owner\"))\n      .catch(() => setRole(\"Owner\"));\n  }, []);\n\n  function togglePolicy(id: string) {\n    const next = policies.map(policy => (policy.id === id ? { ...policy, enabled: !policy.enabled } : policy));\n    setPolicies(next);\n    api.securityPoliciesSet(next).catch(() => null);\n  }\n\n  function runExport() {\n    setExporting(true);\n    setTimeout(() => {\n      setExporting(false);\n      setMessage(\"Audit export queued. You will receive a secure link shortly.\");\n      setTimeout(() => setMessage(null), 2600);\n    }, 900);\n  }\n\n  return (\n    <div className=\"stagger\">\n      <div className=\"row\" style={{ alignItems: \"center\", justifyContent: \"space-between\" }}>\n        <div>\n          <span className=\"pill\">Security & Compliance</span>\n          <h2 className=\"section-title\">Governance for autonomous operations</h2>\n        </div>\n        <a className=\"btn primary\" href=\"/settings\">Workspace settings</a>\n      </div>\n\n      {role !== \"Owner\" && (\n        <div className=\"card\">\n          <h3 className=\"section-title\">Owner-only access</h3>\n          <p className=\"muted\">\n            Security and compliance controls are restricted to Owners.\n          </p>\n        </div>\n      )}\n\n      {role !== \"Owner\" ? null : (\n        <>\n      <div className=\"card\">\n        <h3 className=\"section-title\">Access controls</h3>\n        <p className=\"muted\">Protect the operator interface with strict access and monitoring.</p>\n        <div className=\"table\" style={{ marginTop: 12 }}>\n          {policies.map(policy => (\n            <div className=\"table-row\" key={policy.id}>\n              <div>\n                <strong>{policy.name}</strong>\n                <div className=\"muted\">{policy.description}</div>\n              </div>\n              <span className={`status-pill ${policy.enabled ? \"\" : \"warn\"}`}>\n                <span className=\"status-dot\" />\n                {policy.enabled ? \"Enabled\" : \"Disabled\"}\n              </span>\n              <div className=\"muted\">Policy</div>\n              <button className=\"btn ghost\" onClick={() => togglePolicy(policy.id)}>\n                {policy.enabled ? \"Disable\" : \"Enable\"}\n              </button>\n            </div>\n          ))}\n        </div>\n      </div>\n\n      <div className=\"card\">\n        <div className=\"row\" style={{ alignItems: \"center\", justifyContent: \"space-between\" }}>\n          <div>\n            <h3 className=\"section-title\">Audit exports</h3>\n            <p className=\"muted\">Download a complete decision and action trail for compliance.</p>\n          </div>\n          <button className=\"btn primary\" onClick={runExport} disabled={exporting}>\n            {exporting ? \"Preparing...\" : \"Generate export\"}\n          </button>\n        </div>\n        {message && <div className=\"callout\" style={{ marginTop: 12 }}>{message}</div>}\n        <div className=\"feature-grid\" style={{ marginTop: 16 }}>\n          <div className=\"feature-card\">\n            <strong>Audit log window</strong>\n            <p className=\"muted\">Last 30 days 路 2,142 events</p>\n          </div>\n          <div className=\"feature-card\">\n            <strong>Decision trace</strong>\n            <p className=\"muted\">Includes confidence, intent, and approvals.</p>\n          </div>\n          <div className=\"feature-card\">\n            <strong>Export format</strong>\n            <p className=\"muted\">JSON + CSV, encrypted link.</p>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"card\">\n        <h3 className=\"section-title\">Incident log</h3>\n        <p className=\"muted\">Visibility into access events and system changes.</p>\n        <div className=\"table\" style={{ marginTop: 12 }}>\n          <div className=\"table-row table-header\">\n            <span>Event</span>\n            <span>Status</span>\n            <span>Timestamp</span>\n            <span>Actions</span>\n          </div>\n          {logs.map(entry => (\n            <div className=\"table-row\" key={entry.id}>\n              <div>\n                <strong>{entry.event}</strong>\n                <div className=\"muted\">Operator console</div>\n              </div>\n              <span className={`status-pill ${entry.status === \"investigating\" ? \"warn\" : \"\"}`}>\n                <span className=\"status-dot\" />\n                {entry.status}\n              </span>\n              <span className=\"muted\">{entry.ts}</span>\n              <button className=\"btn ghost\">Review</button>\n            </div>\n          ))}\n        </div>\n      </div>\n        </>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}