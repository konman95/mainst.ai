{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/konnerwest/mainst1/mainstai/app/outcomes/page.tsx"],"sourcesContent":["\"use client\";\nimport { useEffect, useState } from \"react\";\nimport { api } from \"../../lib/api\";\nimport { subscribeCollection } from \"../../lib/realtime\";\nimport { getAuth } from \"../../lib/auth\";\n\nconst outcomeTypes = [\n  \"won\",\n  \"lost\",\n  \"resolved\",\n  \"satisfied\",\n  \"unsatisfied\",\n  \"owner_intervened\",\n  \"follow_up_success\",\n  \"follow_up_failed\"\n];\n\nexport default function OutcomesPage() {\n  const [outcomes, setOutcomes] = useState<any[]>([]);\n  const [error, setError] = useState<string | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [contactId, setContactId] = useState(\"\");\n  const [threadId, setThreadId] = useState(\"\");\n  const [type, setType] = useState(outcomeTypes[0]);\n  const [note, setNote] = useState(\"\");\n\n  async function load() {\n    setError(null);\n    setLoading(true);\n    try {\n      const data = await api.outcomes();\n      setOutcomes(data || []);\n    } catch (e: any) {\n      setError(e?.message || String(e));\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  useEffect(() => {\n    let interval: number | null = null;\n    const auth = getAuth();\n    const uid = auth?.uid;\n    if (uid) {\n      const unsub = subscribeCollection([\"users\", uid, \"outcomes\"], \"ts\", rows => setOutcomes(rows));\n      if (!unsub) {\n        load();\n        interval = window.setInterval(load, 5000);\n      }\n      return () => {\n        if (typeof unsub === \"function\") unsub();\n        if (interval) window.clearInterval(interval);\n      };\n    }\n    load();\n    return () => {};\n  }, []);\n\n  async function submit() {\n    setError(null);\n    try {\n      await api.createOutcome({\n        id: \"\",\n        contact_id: contactId || \"unknown\",\n        thread_id: threadId || \"unknown\",\n        type,\n        note\n      });\n      setContactId(\"\");\n      setThreadId(\"\");\n      setNote(\"\");\n      await load();\n    } catch (e: any) {\n      setError(e?.message || String(e));\n    }\n  }\n\n  return (\n    <div className=\"stagger\">\n      <div>\n        <span className=\"pill\">Outcomes</span>\n        <h2 className=\"section-title\">Outcome tracking</h2>\n        <p className=\"muted\">Close the loop to measure impact and improve decisions.</p>\n      </div>\n\n      <div className=\"card\">\n        <h3 className=\"section-title\">Record outcome</h3>\n        <div className=\"feature-grid\">\n          <input\n            className=\"input\"\n            placeholder=\"Contact ID\"\n            value={contactId}\n            onChange={e => setContactId(e.target.value)}\n          />\n          <input\n            className=\"input\"\n            placeholder=\"Thread ID\"\n            value={threadId}\n            onChange={e => setThreadId(e.target.value)}\n          />\n          <select className=\"select\" value={type} onChange={e => setType(e.target.value)}>\n            {outcomeTypes.map(t => (\n              <option key={t} value={t}>{t}</option>\n            ))}\n          </select>\n        </div>\n        <textarea\n          className=\"textarea\"\n          placeholder=\"Outcome note\"\n          value={note}\n          onChange={e => setNote(e.target.value)}\n          style={{ marginTop: 12 }}\n        />\n        <div className=\"row\" style={{ marginTop: 12 }}>\n          <button className=\"btn primary\" onClick={submit}>Save outcome</button>\n        </div>\n      </div>\n\n      {error && <div className=\"muted\">Error: {error}</div>}\n\n      <div className=\"card\">\n        <h3 className=\"section-title\">Outcome log</h3>\n        {loading ? (\n          <div className=\"muted\">Loading...</div>\n        ) : outcomes.length === 0 ? (\n          <div className=\"muted\">No outcomes recorded yet.</div>\n        ) : (\n          <div className=\"timeline\">\n            {outcomes.map((o: any) => (\n              <div className=\"timeline-item\" key={o.id}>\n                <span className=\"dot\" />\n                <div>\n                  <strong>{o.type}</strong>\n                  <div className=\"muted\">Contact: {o.contact_id}</div>\n                  <div className=\"muted\">{o.note || \"No note\"}</div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;;;AAJA;;;;;AAMA,MAAM,eAAe;IACnB;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD;AAEc,SAAS;;IACtB,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAQ,EAAE;IAClD,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAgB;IAClD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAC3C,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;IACzC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAC,YAAY,CAAC,EAAE;IAChD,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAC;IAEjC,eAAe;QACb,SAAS;QACT,WAAW;QACX,IAAI;YACF,MAAM,OAAO,MAAM,oHAAG,CAAC,QAAQ;YAC/B,YAAY,QAAQ,EAAE;QACxB,EAAE,OAAO,GAAQ;YACf,SAAS,GAAG,WAAW,OAAO;QAChC,SAAU;YACR,WAAW;QACb;IACF;IAEA,IAAA,0KAAS;kCAAC;YACR,IAAI,WAA0B;YAC9B,MAAM,OAAO,IAAA,yHAAO;YACpB,MAAM,MAAM,MAAM;YAClB,IAAI,KAAK;gBACP,MAAM,QAAQ,IAAA,yIAAmB,EAAC;oBAAC;oBAAS;oBAAK;iBAAW,EAAE;oDAAM,CAAA,OAAQ,YAAY;;gBACxF,IAAI,CAAC,OAAO;oBACV;oBACA,WAAW,OAAO,WAAW,CAAC,MAAM;gBACtC;gBACA;8CAAO;wBACL,IAAI,OAAO,UAAU,YAAY;wBACjC,IAAI,UAAU,OAAO,aAAa,CAAC;oBACrC;;YACF;YACA;YACA;0CAAO,KAAO;;QAChB;iCAAG,EAAE;IAEL,eAAe;QACb,SAAS;QACT,IAAI;YACF,MAAM,oHAAG,CAAC,aAAa,CAAC;gBACtB,IAAI;gBACJ,YAAY,aAAa;gBACzB,WAAW,YAAY;gBACvB;gBACA;YACF;YACA,aAAa;YACb,YAAY;YACZ,QAAQ;YACR,MAAM;QACR,EAAE,OAAO,GAAQ;YACf,SAAS,GAAG,WAAW,OAAO;QAChC;IACF;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;;kCACC,6LAAC;wBAAK,WAAU;kCAAO;;;;;;kCACvB,6LAAC;wBAAG,WAAU;kCAAgB;;;;;;kCAC9B,6LAAC;wBAAE,WAAU;kCAAQ;;;;;;;;;;;;0BAGvB,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAG,WAAU;kCAAgB;;;;;;kCAC9B,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCACC,WAAU;gCACV,aAAY;gCACZ,OAAO;gCACP,UAAU,CAAA,IAAK,aAAa,EAAE,MAAM,CAAC,KAAK;;;;;;0CAE5C,6LAAC;gCACC,WAAU;gCACV,aAAY;gCACZ,OAAO;gCACP,UAAU,CAAA,IAAK,YAAY,EAAE,MAAM,CAAC,KAAK;;;;;;0CAE3C,6LAAC;gCAAO,WAAU;gCAAS,OAAO;gCAAM,UAAU,CAAA,IAAK,QAAQ,EAAE,MAAM,CAAC,KAAK;0CAC1E,aAAa,GAAG,CAAC,CAAA,kBAChB,6LAAC;wCAAe,OAAO;kDAAI;uCAAd;;;;;;;;;;;;;;;;kCAInB,6LAAC;wBACC,WAAU;wBACV,aAAY;wBACZ,OAAO;wBACP,UAAU,CAAA,IAAK,QAAQ,EAAE,MAAM,CAAC,KAAK;wBACrC,OAAO;4BAAE,WAAW;wBAAG;;;;;;kCAEzB,6LAAC;wBAAI,WAAU;wBAAM,OAAO;4BAAE,WAAW;wBAAG;kCAC1C,cAAA,6LAAC;4BAAO,WAAU;4BAAc,SAAS;sCAAQ;;;;;;;;;;;;;;;;;YAIpD,uBAAS,6LAAC;gBAAI,WAAU;;oBAAQ;oBAAQ;;;;;;;0BAEzC,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAG,WAAU;kCAAgB;;;;;;oBAC7B,wBACC,6LAAC;wBAAI,WAAU;kCAAQ;;;;;+BACrB,SAAS,MAAM,KAAK,kBACtB,6LAAC;wBAAI,WAAU;kCAAQ;;;;;6CAEvB,6LAAC;wBAAI,WAAU;kCACZ,SAAS,GAAG,CAAC,CAAC,kBACb,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAK,WAAU;;;;;;kDAChB,6LAAC;;0DACC,6LAAC;0DAAQ,EAAE,IAAI;;;;;;0DACf,6LAAC;gDAAI,WAAU;;oDAAQ;oDAAU,EAAE,UAAU;;;;;;;0DAC7C,6LAAC;gDAAI,WAAU;0DAAS,EAAE,IAAI,IAAI;;;;;;;;;;;;;+BALF,EAAE,EAAE;;;;;;;;;;;;;;;;;;;;;;AActD;GA9HwB;KAAA"}}]
}