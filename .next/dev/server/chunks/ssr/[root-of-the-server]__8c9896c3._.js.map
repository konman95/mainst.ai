{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/konnerwest/mainst1/mainstai/lib/auth.ts"],"sourcesContent":["const KEY = \"mainstai_auth\";\nexport function setAuth(a: { uid: string; token: string }) {\n  localStorage.setItem(KEY, JSON.stringify(a));\n}\nexport function getAuth(): { uid: string; token: string } | null {\n  if (typeof window === \"undefined\") return null;\n  const raw = localStorage.getItem(KEY);\n  if (!raw) return null;\n  try {\n    return JSON.parse(raw);\n  } catch (e) {\n    localStorage.removeItem(KEY);\n    return null;\n  }\n}\nexport function clearAuth() {\n  localStorage.removeItem(KEY);\n}\n"],"names":[],"mappings":";;;;;;;;AAAA,MAAM,MAAM;AACL,SAAS,QAAQ,CAAiC;IACvD,aAAa,OAAO,CAAC,KAAK,KAAK,SAAS,CAAC;AAC3C;AACO,SAAS;IACd,wCAAmC,OAAO;;;IAC1C,MAAM;AAQR;AACO,SAAS;IACd,aAAa,UAAU,CAAC;AAC1B"}},
    {"offset": {"line": 53, "column": 0}, "map": {"version":3,"sources":["file:///Users/konnerwest/mainst1/mainstai/lib/api.ts"],"sourcesContent":["import { getAuth } from \"./auth\";\nconst BASE =\n  process.env.NEXT_PUBLIC_API_BASE_URL ||\n  (typeof window !== \"undefined\" ? \"/api\" : \"http://localhost:8000\");\nconst USE_MOCK = (process.env.NEXT_PUBLIC_USE_MOCK || \"false\") === \"true\";\n\nfunction isMockEnabled(): boolean {\n  if (typeof window !== \"undefined\") {\n    const runtime = localStorage.getItem(\"USE_MOCK\");\n    if (runtime === \"true\") return true;\n    if (runtime === \"false\") return false;\n  }\n  return USE_MOCK;\n}\n\nconst MOCK_PATHS = [\"/health\", \"/contacts\", \"/chat\", \"/ownercover\", \"/profile\"];\n\nfunction buildUrl(path: string) {\n  if (isMockEnabled() && MOCK_PATHS.some(p => path === p || path.startsWith(`${p}/`))) {\n    return `/api/mock${path}`;\n  }\n  return BASE + path;\n}\n\nasync function req(path: string, body?: any, method?: string) {\n  const auth = getAuth();\n  const devFallback =\n    typeof window !== \"undefined\" && !auth?.token ? \"dev-guest\" : undefined;\n  let res: Response;\n  try {\n    res = await fetch(buildUrl(path), {\n      method: method || (body ? \"POST\" : \"GET\"),\n      headers: {\n        \"Content-Type\": \"application/json\",\n        ...(auth?.token\n          ? { Authorization: `Bearer ${auth.token}` }\n          : devFallback\n            ? { Authorization: `Bearer ${devFallback}` }\n            : {})\n      },\n      body: body ? JSON.stringify(body) : undefined\n    });\n  } catch (e: any) {\n    throw new Error(\"Network error: \" + (e?.message || String(e)));\n  }\n\n  if (!res.ok) {\n    const text = await res.text().catch(() => `HTTP ${res.status}`);\n    throw new Error(text);\n  }\n\n  try {\n    return await res.json();\n  } catch (e) {\n    return null;\n  }\n}\n\nexport const api = {\n  health: () => req(\"/health\"),\n  chat: (b: any) => req(\"/chat\", b),\n  chatManual: (b: any) => req(\"/chat/manual\", b),\n  chatHistory: (conversationId: string) =>\n    req(`/chat/history?conversationId=${encodeURIComponent(conversationId)}`),\n  ownerGet: () => req(\"/ownercover/settings\"),\n  ownerSet: (b: any) => req(\"/ownercover/settings\", b),\n  ownerInbound: (b: any) => req(\"/ownercover/handleInbound\", b),\n  profileGet: () => req(\"/profile\"),\n  profileSet: (b: any) => req(\"/profile\", b, \"POST\"),\n  billingGet: () => req(\"/billing\"),\n  billingSet: (b: any) => req(\"/billing\", b, \"POST\"),\n  integrationsGet: () => req(\"/integrations\"),\n  integrationsSet: (b: any) => req(\"/integrations\", b, \"POST\"),\n  teamGet: () => req(\"/team\"),\n  teamSet: (b: any) => req(\"/team\", b, \"POST\"),\n  accessGet: () => req(\"/access\"),\n  accessSet: (b: any) => req(\"/access\", b, \"POST\"),\n  workspaces: () => req(\"/workspaces\"),\n  workspacesSet: (b: any) => req(\"/workspaces\", b, \"POST\"),\n  workspacesSelect: (id: string) => req(\"/workspaces/select\", { id }, \"POST\"),\n  workspacesMembers: (workspaceId?: string) =>\n    req(workspaceId ? `/workspaces/members?workspace_id=${encodeURIComponent(workspaceId)}` : \"/workspaces/members\"),\n  workspacesMembersSet: (items: any, workspaceId?: string) =>\n    req(\n      workspaceId ? `/workspaces/members?workspace_id=${encodeURIComponent(workspaceId)}` : \"/workspaces/members\",\n      items,\n      \"POST\"\n    ),\n  automationRules: () => req(\"/automation/rules\"),\n  automationRulesSet: (b: any) => req(\"/automation/rules\", b, \"POST\"),\n  automationGuardrails: () => req(\"/automation/guardrails\"),\n  automationGuardrailsSet: (b: any) => req(\"/automation/guardrails\", b, \"POST\"),\n  securityPolicies: () => req(\"/security/policies\"),\n  securityPoliciesSet: (b: any) => req(\"/security/policies\", b, \"POST\"),\n  securityLogs: () => req(\"/security/logs\"),\n  notifications: () => req(\"/notifications\"),\n  notificationsUpdate: (b: any) => req(\"/notifications\", b, \"POST\"),\n  notificationsRouting: () => req(\"/notifications/routing\"),\n  notificationsRoutingSet: (b: any) => req(\"/notifications/routing\", b, \"POST\"),\n  contacts: () => req(\"/contacts\"),\n  createContact: (b: any) => req(\"/contacts\", b, \"POST\"),\n  updateContact: (id: string, b: any) => req(`/contacts/${id}`, b, \"PUT\"),\n  deleteContact: (id: string) => req(`/contacts/${id}`, undefined, \"DELETE\"),\n  decisions: (contactId?: string) =>\n    req(contactId ? `/decisions?contact_id=${encodeURIComponent(contactId)}` : \"/decisions\"),\n  actionQueue: () => req(\"/actionQueue\"),\n  approveAction: (actionId: string, approve: boolean) =>\n    req(\"/actionQueue/approve\", { action_id: actionId, approve }, \"POST\"),\n  audit: () => req(\"/auditLog\"),\n  outcomes: (contactId?: string) =>\n    req(contactId ? `/outcomes?contact_id=${encodeURIComponent(contactId)}` : \"/outcomes\"),\n  createOutcome: (b: any) => req(\"/outcomes\", b, \"POST\"),\n  threads: (contactId?: string) =>\n    req(contactId ? `/threads?contact_id=${encodeURIComponent(contactId)}` : \"/threads\"),\n  threadMessages: (threadId: string) => req(`/threads/${encodeURIComponent(threadId)}/messages`),\n  dashboardSummary: () => req(\"/dashboard/summary\"),\n  weeklySummary: () => req(\"/dashboard/summary?range=week\"),\n  orgSummary: () => req(\"/org/summary\"),\n  orgWeeklySummary: () => req(\"/org/summary?range=week\")\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 167, "column": 0}, "map": {"version":3,"sources":["file:///Users/konnerwest/mainst1/mainstai/components/Nav.tsx"],"sourcesContent":["\"use client\";\nimport Link from \"next/link\";\nimport { clearAuth, getAuth } from \"../lib/auth\";\nimport { useEffect, useRef, useState } from \"react\";\nimport { usePathname } from \"next/navigation\";\nimport { api } from \"../lib/api\";\n\nexport default function Nav() {\n  const pathname = usePathname();\n  const [auth, setAuth] = useState<{ uid: string; token: string } | null>(null);\n  const [workspaceName, setWorkspaceName] = useState(\"Main St AI Business\");\n  const [planName, setPlanName] = useState(\"Operator Pro\");\n  const [menuOpen, setMenuOpen] = useState(false);\n  const [role, setRole] = useState<\"Owner\" | \"Manager\" | \"Agent\">(\"Owner\");\n  const [workspaceId, setWorkspaceId] = useState(\"primary\");\n  const [workspaces, setWorkspaces] = useState<Array<{ id: string; name: string }>>([]);\n  const menuRef = useRef<HTMLDivElement | null>(null);\n  const triggerRef = useRef<HTMLButtonElement | null>(null);\n\n  // Read auth only on the client after mount to avoid SSR / hydration mismatch\n  useEffect(() => {\n    setAuth(getAuth());\n  }, []);\n\n  useEffect(() => {\n    let active = true;\n    const load = async () => {\n      try {\n        const access = await api.accessGet();\n        if (active && (access?.effective_role || access?.role)) {\n          setRole(access.effective_role || access.role);\n        }\n        if (active && access?.workspace_id) setWorkspaceId(access.workspace_id);\n      } catch {\n        // ignore access load errors in nav\n      }\n      try {\n        const workspaces = await api.workspaces();\n        if (active) {\n          setWorkspaces(workspaces?.items || []);\n          const match = (workspaces?.items || []).find((item: any) => item.id === (workspaces?.current || workspaceId));\n          if (match?.name) setWorkspaceName(match.name);\n        }\n      } catch {\n        // ignore workspace load errors in nav\n      }\n      try {\n        const billing = await api.billingGet();\n        if (billing?.plan) {\n          const label =\n            billing.plan === \"core\" ? \"Coverage Core\" : billing.plan === \"enterprise\" ? \"Enterprise\" : \"Operator Pro\";\n          if (active) setPlanName(label);\n        }\n      } catch {\n        // ignore billing load errors in nav\n      }\n    };\n    load();\n    return () => {\n      active = false;\n    };\n  }, []);\n\n  useEffect(() => {\n    const handleKey = (event: KeyboardEvent) => {\n      if (event.key === \"Escape\") setMenuOpen(false);\n    };\n    const handleClick = (event: MouseEvent) => {\n      if (!menuOpen) return;\n      const target = event.target as Node | null;\n      const panel = menuRef.current;\n      const trigger = triggerRef.current;\n      if (!panel || !target) return;\n      if (panel.contains(target) || trigger?.contains(target)) return;\n      setMenuOpen(false);\n    };\n    window.addEventListener(\"keydown\", handleKey);\n    window.addEventListener(\"mousedown\", handleClick);\n    return () => {\n      window.removeEventListener(\"keydown\", handleKey);\n      window.removeEventListener(\"mousedown\", handleClick);\n    };\n  }, [menuOpen]);\n\n  useEffect(() => {\n    if (!menuOpen) return;\n    const panel = menuRef.current;\n    if (!panel) return;\n    const focusables = panel.querySelectorAll<HTMLElement>(\n      \"a[href], button:not([disabled]), [tabindex]:not([tabindex='-1'])\"\n    );\n    if (focusables.length > 0) focusables[0].focus();\n\n    const handleTab = (event: KeyboardEvent) => {\n      if (event.key !== \"Tab\") return;\n      const list = Array.from(\n        panel.querySelectorAll<HTMLElement>(\n          \"a[href], button:not([disabled]), [tabindex]:not([tabindex='-1'])\"\n        )\n      );\n      if (list.length === 0) return;\n      const first = list[0];\n      const last = list[list.length - 1];\n      if (event.shiftKey && document.activeElement === first) {\n        event.preventDefault();\n        last.focus();\n      } else if (!event.shiftKey && document.activeElement === last) {\n        event.preventDefault();\n        first.focus();\n      }\n    };\n\n    document.addEventListener(\"keydown\", handleTab);\n    return () => document.removeEventListener(\"keydown\", handleTab);\n  }, [menuOpen]);\n\n  const canManageCoverage = role !== \"Agent\";\n  const canSeeAutomation = role !== \"Agent\";\n  const canSeeSecurity = role === \"Owner\";\n  const canSeeSettings = role !== \"Agent\";\n  const canSeeOrg = role !== \"Agent\";\n  const canSwitchWorkspace = role !== \"Agent\";\n\n  async function selectWorkspace(id: string) {\n    setWorkspaceId(id);\n    setMenuOpen(false);\n    try {\n      await api.workspacesSelect(id);\n    } catch {\n      // ignore selection errors\n    }\n    if (typeof window !== \"undefined\") {\n      window.setTimeout(() => window.location.reload(), 400);\n    }\n  }\n\n  return (\n    <div className=\"nav\">\n      <div className=\"nav-inner\">\n        <div className=\"nav-brand\">\n          <span className=\"pill\">Main St AI</span>\n          <div className=\"nav-meta\">\n            <strong>{workspaceName}</strong>\n            <span className=\"muted\">Plan: {planName}</span>\n          </div>\n        </div>\n        <div className=\"nav-actions\">\n          <button\n            className=\"btn ghost menu-trigger\"\n            onClick={() => setMenuOpen(v => !v)}\n            aria-expanded={menuOpen}\n            aria-controls=\"mainstai-menu\"\n            aria-label=\"Open navigation menu\"\n            aria-haspopup=\"menu\"\n            ref={triggerRef}\n          >\n            {menuOpen ? \"Close\" : \"Menu\"}\n          </button>\n        </div>\n      </div>\n      {menuOpen && (\n        <div className=\"menu-backdrop\" aria-hidden=\"true\" />\n      )}\n      <div\n        id=\"mainstai-menu\"\n        className={`menu-panel ${menuOpen ? \"open\" : \"\"}`}\n        ref={menuRef}\n        role=\"menu\"\n      >\n        <div className=\"menu-section\">\n          <div className=\"menu-title\">Quick actions</div>\n          <div className=\"menu-actions\">\n            <a className=\"menu-action\" href=\"/chat\" onClick={() => setMenuOpen(false)}>\n              <span className=\"menu-icon chat\" aria-hidden=\"true\" />\n              Start chat\n            </a>\n            <a className=\"menu-action\" href=\"/contacts\" onClick={() => setMenuOpen(false)}>\n              <span className=\"menu-icon contacts\" aria-hidden=\"true\" />\n              New contact\n            </a>\n            {canManageCoverage && (\n              <a className=\"menu-action\" href=\"/owner-cover#simulate-inbound\" onClick={() => setMenuOpen(false)}>\n                <span className=\"menu-icon simulate\" aria-hidden=\"true\" />\n                Simulate inbound\n              </a>\n            )}\n            <a className=\"menu-action\" href=\"/notifications\" onClick={() => setMenuOpen(false)}>\n              <span className=\"menu-icon alerts\" aria-hidden=\"true\" />\n              View alerts\n            </a>\n          </div>\n        </div>\n        {canSwitchWorkspace && workspaces.length > 0 && (\n          <div className=\"menu-section\">\n            <div className=\"menu-title\">Workspace switcher</div>\n            <div className=\"menu-actions\">\n              {workspaces.map(workspace => (\n                <button\n                  key={workspace.id}\n                  className={`menu-action ${workspaceId === workspace.id ? \"active\" : \"\"}`}\n                  onClick={() => selectWorkspace(workspace.id)}\n                >\n                  <span className=\"menu-icon\" aria-hidden=\"true\" />\n                  {workspace.name}\n                </button>\n              ))}\n            </div>\n          </div>\n        )}\n        <div className=\"menu-title\">Workspace</div>\n        <div className=\"menu-grid\">\n          <Link className={`nav-link ${pathname === \"/dashboard\" ? \"active\" : \"\"}`} href=\"/dashboard\" onClick={() => setMenuOpen(false)}>\n            Dashboard\n          </Link>\n          <Link className={`nav-link ${pathname === \"/profile\" ? \"active\" : \"\"}`} href=\"/profile\" onClick={() => setMenuOpen(false)}>\n            Profile\n          </Link>\n          <Link className={`nav-link ${pathname === \"/contacts\" ? \"active\" : \"\"}`} href=\"/contacts\" onClick={() => setMenuOpen(false)}>\n            Contacts\n          </Link>\n          <Link className={`nav-link ${pathname === \"/chat\" ? \"active\" : \"\"}`} href=\"/chat\" onClick={() => setMenuOpen(false)}>\n            Chat\n          </Link>\n          {canManageCoverage && (\n            <Link className={`nav-link ${pathname === \"/owner-cover\" ? \"active\" : \"\"}`} href=\"/owner-cover\" onClick={() => setMenuOpen(false)}>\n              Owner Cover\n            </Link>\n          )}\n          {canSeeAutomation && (\n            <Link className={`nav-link ${pathname === \"/automation\" ? \"active\" : \"\"}`} href=\"/automation\" onClick={() => setMenuOpen(false)}>\n              Automation\n            </Link>\n          )}\n          <Link className={`nav-link ${pathname === \"/decision-feed\" ? \"active\" : \"\"}`} href=\"/decision-feed\" onClick={() => setMenuOpen(false)}>\n            Decisions\n          </Link>\n          {canSeeOrg && (\n            <Link className={`nav-link ${pathname === \"/org\" ? \"active\" : \"\"}`} href=\"/org\" onClick={() => setMenuOpen(false)}>\n              Org Analytics\n            </Link>\n          )}\n          <Link className={`nav-link ${pathname === \"/action-queue\" ? \"active\" : \"\"}`} href=\"/action-queue\" onClick={() => setMenuOpen(false)}>\n            Action Queue\n          </Link>\n          <Link className={`nav-link ${pathname === \"/notifications\" ? \"active\" : \"\"}`} href=\"/notifications\" onClick={() => setMenuOpen(false)}>\n            Notifications\n          </Link>\n          <Link className={`nav-link ${pathname === \"/memory\" ? \"active\" : \"\"}`} href=\"/memory\" onClick={() => setMenuOpen(false)}>\n            Memory\n          </Link>\n          <Link className={`nav-link ${pathname === \"/outcomes\" ? \"active\" : \"\"}`} href=\"/outcomes\" onClick={() => setMenuOpen(false)}>\n            Outcomes\n          </Link>\n          {canSeeSettings && (\n            <Link className={`nav-link ${pathname === \"/settings\" ? \"active\" : \"\"}`} href=\"/settings\" onClick={() => setMenuOpen(false)}>\n              Settings\n            </Link>\n          )}\n          {canSeeSecurity && (\n            <Link className={`nav-link ${pathname === \"/security\" ? \"active\" : \"\"}`} href=\"/security\" onClick={() => setMenuOpen(false)}>\n              Security\n            </Link>\n          )}\n          <Link className={`nav-link ${pathname === \"/how-it-works\" ? \"active\" : \"\"}`} href=\"/how-it-works\" onClick={() => setMenuOpen(false)}>\n            How It Works\n          </Link>\n        </div>\n        <div className=\"menu-footer\">\n          {auth ? (\n            <button\n              className=\"btn ghost\"\n              onClick={() => {\n                clearAuth();\n                location.href = \"/login\";\n              }}\n            >\n              Logout\n            </button>\n          ) : (\n            <Link className={`nav-link ${pathname === \"/login\" ? \"active\" : \"\"}`} href=\"/login\" onClick={() => setMenuOpen(false)}>\n              Login\n            </Link>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 752, "column": 0}, "map": {"version":3,"sources":["file:///Users/konnerwest/mainst1/mainstai/components/DevToolbar.tsx"],"sourcesContent":["\"use client\";\nimport { useEffect, useState } from \"react\";\n\nexport default function DevToolbar() {\n  const [mock, setMock] = useState<boolean | null>(null);\n\n  useEffect(() => {\n    const v = localStorage.getItem(\"USE_MOCK\");\n    if (v === null) setMock(null);\n    else setMock(v === \"true\");\n  }, []);\n\n  function toggle() {\n    const next = !(mock === true);\n    localStorage.setItem(\"USE_MOCK\", next ? \"true\" : \"false\");\n    setMock(next);\n    // don't force reload; let components pick up change on next action\n    // but advise user to reload for deterministic behavior\n  }\n\n  function clear() {\n    localStorage.removeItem(\"USE_MOCK\");\n    setMock(null);\n  }\n\n  return (\n    <div className=\"devbar\">\n      <div className=\"devbar-inner\">\n        <strong>Dev</strong>\n        <button className=\"btn ghost\" onClick={toggle}>\n          {mock === null ? \"Mock: unset\" : mock ? \"Mock: ON\" : \"Mock: OFF\"}\n        </button>\n        <button className=\"btn ghost\" onClick={clear}>Clear</button>\n        <div style={{ marginLeft: \"auto\" }}>\n          Tip: toggle changes runtime mock flag stored in localStorage\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AACA;AADA;;;AAGe,SAAS;IACtB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAiB;IAEjD,IAAA,kNAAS,EAAC;QACR,MAAM,IAAI,aAAa,OAAO,CAAC;QAC/B,IAAI,MAAM,MAAM,QAAQ;aACnB,QAAQ,MAAM;IACrB,GAAG,EAAE;IAEL,SAAS;QACP,MAAM,OAAO,CAAC,CAAC,SAAS,IAAI;QAC5B,aAAa,OAAO,CAAC,YAAY,OAAO,SAAS;QACjD,QAAQ;IACR,mEAAmE;IACnE,uDAAuD;IACzD;IAEA,SAAS;QACP,aAAa,UAAU,CAAC;QACxB,QAAQ;IACV;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;8BAAO;;;;;;8BACR,8OAAC;oBAAO,WAAU;oBAAY,SAAS;8BACpC,SAAS,OAAO,gBAAgB,OAAO,aAAa;;;;;;8BAEvD,8OAAC;oBAAO,WAAU;oBAAY,SAAS;8BAAO;;;;;;8BAC9C,8OAAC;oBAAI,OAAO;wBAAE,YAAY;oBAAO;8BAAG;;;;;;;;;;;;;;;;;AAM5C"}},
    {"offset": {"line": 925, "column": 0}, "map": {"version":3,"sources":["file:///Users/konnerwest/mainst1/mainstai/lib/firebase.ts"],"sourcesContent":["import { initializeApp, getApps, getApp } from \"firebase/app\";\nimport { getAnalytics } from \"firebase/analytics\";\n\nconst firebaseConfig = {\n  apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,\n  authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,\n  databaseURL: process.env.NEXT_PUBLIC_FIREBASE_DATABASE_URL,\n  projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,\n  storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,\n  messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,\n  appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,\n  measurementId: process.env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID,\n};\n\nconst app = !getApps().length ? initializeApp(firebaseConfig) : getApp();\nlet analytics: ReturnType<typeof getAnalytics> | null = null;\nif (typeof window !== \"undefined\") {\n  try { analytics = getAnalytics(app); } catch (e) { analytics = null; }\n}\n\nexport { app as firebaseApp, analytics };\nexport default app;\n"],"names":[],"mappings":";;;;;;;;AAAA;AAAA;AACA;;;AAEA,MAAM,iBAAiB;IACrB,MAAM;IACN,UAAU;IACV,WAAW;IACX,SAAS;IACT,aAAa;IACb,iBAAiB;IACjB,KAAK;IACL,aAAa;AACf;AAEA,MAAM,MAAM,CAAC,IAAA,2KAAO,IAAG,MAAM,GAAG,IAAA,iLAAa,EAAC,kBAAkB,IAAA,0KAAM;AACtE,IAAI,YAAoD;AACxD;;;uCAKe"}},
    {"offset": {"line": 958, "column": 0}, "map": {"version":3,"sources":["file:///Users/konnerwest/mainst1/mainstai/lib/firebaseClient.ts"],"sourcesContent":["import firebaseApp from \"./firebase\";\nimport { getFirestore } from \"firebase/firestore\";\n\nexport const db = getFirestore(firebaseApp as any);\n"],"names":[],"mappings":";;;;AAAA;AACA;AAAA;;;AAEO,MAAM,KAAK,IAAA,iLAAY,EAAC,0HAAW"}},
    {"offset": {"line": 972, "column": 0}, "map": {"version":3,"sources":["file:///Users/konnerwest/mainst1/mainstai/lib/realtime.ts"],"sourcesContent":["import { collection, doc, onSnapshot, orderBy, query } from \"firebase/firestore\";\nimport { db } from \"./firebaseClient\";\nimport { getAuth } from \"./auth\";\n\nexport function canUseRealtime() {\n  const auth = getAuth();\n  if (!auth || !auth.token) return false;\n  if (auth.token.startsWith(\"dev-\")) return false;\n  return true;\n}\n\nexport function subscribeCollection(\n  pathParts: string[],\n  orderField: string,\n  onData: (rows: any[]) => void\n) {\n  const auth = getAuth();\n  if (!auth || !canUseRealtime()) return null;\n  const ref = collection(db, ...pathParts);\n  const q = orderField ? query(ref, orderBy(orderField, \"desc\")) : ref;\n  return onSnapshot(q, snap => {\n    const rows = snap.docs.map(docSnap => ({ id: docSnap.id, ...docSnap.data() }));\n    onData(rows);\n  });\n}\n\nexport function subscribeDoc(\n  pathParts: string[],\n  onData: (data: any | null) => void\n) {\n  const auth = getAuth();\n  if (!auth || !canUseRealtime()) return null;\n  const ref = doc(db, ...pathParts);\n  return onSnapshot(ref, snap => {\n    onData(snap.exists() ? snap.data() : null);\n  });\n}\n"],"names":[],"mappings":";;;;;;;;AAAA;AAAA;AACA;AACA;;;;AAEO,SAAS;IACd,MAAM,OAAO,IAAA,sHAAO;IACpB,IAAI,CAAC,QAAQ,CAAC,KAAK,KAAK,EAAE,OAAO;IACjC,IAAI,KAAK,KAAK,CAAC,UAAU,CAAC,SAAS,OAAO;IAC1C,OAAO;AACT;AAEO,SAAS,oBACd,SAAmB,EACnB,UAAkB,EAClB,MAA6B;IAE7B,MAAM,OAAO,IAAA,sHAAO;IACpB,IAAI,CAAC,QAAQ,CAAC,kBAAkB,OAAO;IACvC,MAAM,MAAM,IAAA,+KAAU,EAAC,2HAAE,KAAK;IAC9B,MAAM,IAAI,aAAa,IAAA,0KAAK,EAAC,KAAK,IAAA,4KAAO,EAAC,YAAY,WAAW;IACjE,OAAO,IAAA,+KAAU,EAAC,GAAG,CAAA;QACnB,MAAM,OAAO,KAAK,IAAI,CAAC,GAAG,CAAC,CAAA,UAAW,CAAC;gBAAE,IAAI,QAAQ,EAAE;gBAAE,GAAG,QAAQ,IAAI,EAAE;YAAC,CAAC;QAC5E,OAAO;IACT;AACF;AAEO,SAAS,aACd,SAAmB,EACnB,MAAkC;IAElC,MAAM,OAAO,IAAA,sHAAO;IACpB,IAAI,CAAC,QAAQ,CAAC,kBAAkB,OAAO;IACvC,MAAM,MAAM,IAAA,wKAAG,EAAC,2HAAE,KAAK;IACvB,OAAO,IAAA,+KAAU,EAAC,KAAK,CAAA;QACrB,OAAO,KAAK,MAAM,KAAK,KAAK,IAAI,KAAK;IACvC;AACF"}},
    {"offset": {"line": 1018, "column": 0}, "map": {"version":3,"sources":["file:///Users/konnerwest/mainst1/mainstai/components/LiveTicker.tsx"],"sourcesContent":["\"use client\";\nimport { useEffect, useState } from \"react\";\nimport { api } from \"../lib/api\";\nimport { subscribeCollection, subscribeDoc } from \"../lib/realtime\";\nimport { getAuth } from \"../lib/auth\";\n\nexport default function LiveTicker() {\n  const [summary, setSummary] = useState<any>(null);\n  const [pending, setPending] = useState(0);\n\n  useEffect(() => {\n    let interval: number | null = null;\n    const auth = getAuth();\n    const uid = auth?.uid;\n    if (!uid) return;\n\n    const today = new Date();\n    const day =\n      today.getFullYear().toString() +\n      String(today.getMonth() + 1).padStart(2, \"0\") +\n      String(today.getDate()).padStart(2, \"0\");\n\n    const unsubStats = subscribeDoc(\n      [\"users\", uid, \"stats\", `daily_${day}`],\n      data => setSummary({ day, stats: data || {} })\n    );\n    const unsubQueue = subscribeCollection(\n      [\"users\", uid, \"actionQueue\"],\n      \"created_ts\",\n      rows => setPending(rows.filter(r => r.status === \"needs_approval\").length)\n    );\n\n    if (!unsubStats || !unsubQueue) {\n      const poll = async () => {\n        try {\n          const data = await api.dashboardSummary();\n          setSummary(data || null);\n          const queue = await api.actionQueue();\n          setPending((queue || []).filter((r: any) => r.status === \"needs_approval\").length);\n        } catch {\n          // ignore poll errors\n        }\n      };\n      poll();\n      interval = window.setInterval(poll, 5000);\n    }\n\n    return () => {\n      if (typeof unsubStats === \"function\") unsubStats();\n      if (typeof unsubQueue === \"function\") unsubQueue();\n      if (interval) window.clearInterval(interval);\n    };\n  }, []);\n\n  const stats = summary?.stats || {};\n  return (\n    <div className=\"card tight\" style={{ margin: \"16px auto\", maxWidth: 1100 }}>\n      <div className=\"row\" style={{ alignItems: \"center\", justifyContent: \"space-between\" }}>\n        <div className=\"muted\">\n          AI handled <strong>{stats.chat_messages || 0}</strong> messages today\n        </div>\n        <div className=\"muted\">\n          <strong>{pending}</strong> pending approvals\n        </div>\n        <div className=\"muted\">\n          Saved <strong>{stats.minutes_saved || 0}</strong> minutes today\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AAJA;;;;;;AAMe,SAAS;IACtB,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAM;IAC5C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IAEvC,IAAA,kNAAS,EAAC;QACR,IAAI,WAA0B;QAC9B,MAAM,OAAO,IAAA,sHAAO;QACpB,MAAM,MAAM,MAAM;QAClB,IAAI,CAAC,KAAK;QAEV,MAAM,QAAQ,IAAI;QAClB,MAAM,MACJ,MAAM,WAAW,GAAG,QAAQ,KAC5B,OAAO,MAAM,QAAQ,KAAK,GAAG,QAAQ,CAAC,GAAG,OACzC,OAAO,MAAM,OAAO,IAAI,QAAQ,CAAC,GAAG;QAEtC,MAAM,aAAa,IAAA,+HAAY,EAC7B;YAAC;YAAS;YAAK;YAAS,CAAC,MAAM,EAAE,KAAK;SAAC,EACvC,CAAA,OAAQ,WAAW;gBAAE;gBAAK,OAAO,QAAQ,CAAC;YAAE;QAE9C,MAAM,aAAa,IAAA,sIAAmB,EACpC;YAAC;YAAS;YAAK;SAAc,EAC7B,cACA,CAAA,OAAQ,WAAW,KAAK,MAAM,CAAC,CAAA,IAAK,EAAE,MAAM,KAAK,kBAAkB,MAAM;QAG3E,IAAI,CAAC,cAAc,CAAC,YAAY;YAC9B,MAAM,OAAO;gBACX,IAAI;oBACF,MAAM,OAAO,MAAM,iHAAG,CAAC,gBAAgB;oBACvC,WAAW,QAAQ;oBACnB,MAAM,QAAQ,MAAM,iHAAG,CAAC,WAAW;oBACnC,WAAW,CAAC,SAAS,EAAE,EAAE,MAAM,CAAC,CAAC,IAAW,EAAE,MAAM,KAAK,kBAAkB,MAAM;gBACnF,EAAE,OAAM;gBACN,qBAAqB;gBACvB;YACF;YACA;YACA,WAAW,OAAO,WAAW,CAAC,MAAM;QACtC;QAEA,OAAO;YACL,IAAI,OAAO,eAAe,YAAY;YACtC,IAAI,OAAO,eAAe,YAAY;YACtC,IAAI,UAAU,OAAO,aAAa,CAAC;QACrC;IACF,GAAG,EAAE;IAEL,MAAM,QAAQ,SAAS,SAAS,CAAC;IACjC,qBACE,8OAAC;QAAI,WAAU;QAAa,OAAO;YAAE,QAAQ;YAAa,UAAU;QAAK;kBACvE,cAAA,8OAAC;YAAI,WAAU;YAAM,OAAO;gBAAE,YAAY;gBAAU,gBAAgB;YAAgB;;8BAClF,8OAAC;oBAAI,WAAU;;wBAAQ;sCACV,8OAAC;sCAAQ,MAAM,aAAa,IAAI;;;;;;wBAAW;;;;;;;8BAExD,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;sCAAQ;;;;;;wBAAiB;;;;;;;8BAE5B,8OAAC;oBAAI,WAAU;;wBAAQ;sCACf,8OAAC;sCAAQ,MAAM,aAAa,IAAI;;;;;;wBAAW;;;;;;;;;;;;;;;;;;AAK3D"}}]
}