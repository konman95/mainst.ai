{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/konnerwest/mainst1/mainstai/app/decision-feed/page.tsx"],"sourcesContent":["\"use client\";\nimport { useEffect, useState } from \"react\";\nimport { api } from \"../../lib/api\";\nimport { subscribeCollection } from \"../../lib/realtime\";\nimport { getAuth } from \"../../lib/auth\";\n\nexport default function DecisionFeed() {\n  const [decisions, setDecisions] = useState<any[]>([]);\n  const [filter, setFilter] = useState<string>(\"all\");\n  const [error, setError] = useState<string | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  async function load() {\n    setError(null);\n    setLoading(true);\n    try {\n      const data = await api.decisions();\n      setDecisions(data || []);\n    } catch (e: any) {\n      setError(e?.message || String(e));\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  useEffect(() => {\n    let interval: number | null = null;\n    const auth = getAuth();\n    const uid = auth?.uid;\n    if (uid) {\n      const unsub = subscribeCollection([\"users\", uid, \"decisions\"], \"created_ts\", rows => setDecisions(rows));\n      if (!unsub) {\n        load();\n        interval = window.setInterval(load, 5000);\n      }\n      return () => {\n        if (typeof unsub === \"function\") unsub();\n        if (interval) window.clearInterval(interval);\n      };\n    }\n    load();\n    return () => {};\n  }, []);\n\n  const filtered = decisions.filter(d => {\n    if (filter === \"all\") return true;\n    if (filter === \"send\") return d.decision === \"send\";\n    if (filter === \"queue\") return d.decision === \"queue\";\n    if (filter === \"block\") return d.decision === \"block\";\n    return true;\n  });\n\n  return (\n    <div className=\"stagger\">\n      <div>\n        <span className=\"pill\">Decision Core</span>\n        <h2 className=\"section-title\">Decision feed</h2>\n        <p className=\"muted\">Every AI decision, in order, with reason and confidence.</p>\n      </div>\n\n      <div className=\"row\">\n        <button className=\"btn ghost\" onClick={load}>Refresh</button>\n        <select className=\"select\" value={filter} onChange={e=>setFilter(e.target.value)}>\n          <option value=\"all\">All</option>\n          <option value=\"send\">Sent</option>\n          <option value=\"queue\">Queued</option>\n          <option value=\"block\">Blocked</option>\n        </select>\n      </div>\n\n      {error && <div className=\"muted\">Error: {error}</div>}\n\n      <div className=\"card\">\n        {loading ? (\n          <div className=\"muted\">Loading...</div>\n        ) : filtered.length === 0 ? (\n          <div className=\"muted\">No decisions yet.</div>\n        ) : (\n          <div className=\"timeline\">\n            {filtered.map((d: any) => (\n              <div className=\"timeline-item\" key={d.id}>\n                <span className=\"dot\" />\n                <div>\n                  <strong>{d.intent || \"decision\"}</strong>\n                  <div className=\"row\" style={{ marginTop: 6 }}>\n                    <span className=\"badge\">{d.decision}</span>\n                    <span className=\"badge\">Confidence {Math.round((d.confidence || 0) * 100)}%</span>\n                    {d.risk !== undefined && (\n                      <span className=\"badge\">Risk {Math.round(d.risk * 100)}%</span>\n                    )}\n                  </div>\n                  <div className=\"muted\" style={{ marginTop: 6 }}>{d.reason}</div>\n                  <div className=\"muted\">Contact: {d.contact_id}</div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}