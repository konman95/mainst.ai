{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/konnerwest/mainst1/mainstai/lib/api.ts"],"sourcesContent":["import { getAuth } from \"./auth\";\nconst BASE =\n  process.env.NEXT_PUBLIC_API_BASE_URL ||\n  (typeof window !== \"undefined\" ? \"/api\" : \"http://localhost:8000\");\nconst USE_MOCK = (process.env.NEXT_PUBLIC_USE_MOCK || \"false\") === \"true\";\n\nfunction isMockEnabled(): boolean {\n  if (typeof window !== \"undefined\") {\n    const runtime = localStorage.getItem(\"USE_MOCK\");\n    if (runtime === \"true\") return true;\n    if (runtime === \"false\") return false;\n  }\n  return USE_MOCK;\n}\n\nconst MOCK_PATHS = [\"/health\", \"/contacts\", \"/chat\", \"/ownercover\", \"/profile\"];\n\nfunction buildUrl(path: string) {\n  if (isMockEnabled() && MOCK_PATHS.some(p => path === p || path.startsWith(`${p}/`))) {\n    return `/api/mock${path}`;\n  }\n  return BASE + path;\n}\n\nasync function req(path: string, body?: any, method?: string) {\n  const auth = getAuth();\n  let res: Response;\n  try {\n    res = await fetch(buildUrl(path), {\n      method: method || (body ? \"POST\" : \"GET\"),\n      headers: {\n        \"Content-Type\": \"application/json\",\n        ...(auth ? { Authorization: `Bearer ${auth.token}` } : {})\n      },\n      body: body ? JSON.stringify(body) : undefined\n    });\n  } catch (e: any) {\n    throw new Error(\"Network error: \" + (e?.message || String(e)));\n  }\n\n  if (!res.ok) {\n    const text = await res.text().catch(() => `HTTP ${res.status}`);\n    throw new Error(text);\n  }\n\n  try {\n    return await res.json();\n  } catch (e) {\n    return null;\n  }\n}\n\nexport const api = {\n  health: () => req(\"/health\"),\n  chat: (b: any) => req(\"/chat\", b),\n  chatManual: (b: any) => req(\"/chat/manual\", b),\n  chatHistory: (conversationId: string) =>\n    req(`/chat/history?conversationId=${encodeURIComponent(conversationId)}`),\n  ownerGet: () => req(\"/ownercover/settings\"),\n  ownerSet: (b: any) => req(\"/ownercover/settings\", b),\n  ownerInbound: (b: any) => req(\"/ownercover/handleInbound\", b),\n  profileGet: () => req(\"/profile\"),\n  profileSet: (b: any) => req(\"/profile\", b, \"POST\"),\n  contacts: () => req(\"/contacts\"),\n  createContact: (b: any) => req(\"/contacts\", b, \"POST\"),\n  updateContact: (id: string, b: any) => req(`/contacts/${id}`, b, \"PUT\"),\n  deleteContact: (id: string) => req(`/contacts/${id}`, undefined, \"DELETE\"),\n  decisions: (contactId?: string) =>\n    req(contactId ? `/decisions?contact_id=${encodeURIComponent(contactId)}` : \"/decisions\"),\n  actionQueue: () => req(\"/actionQueue\"),\n  approveAction: (actionId: string, approve: boolean) =>\n    req(\"/actionQueue/approve\", { action_id: actionId, approve }, \"POST\"),\n  audit: () => req(\"/auditLog\"),\n  outcomes: (contactId?: string) =>\n    req(contactId ? `/outcomes?contact_id=${encodeURIComponent(contactId)}` : \"/outcomes\"),\n  createOutcome: (b: any) => req(\"/outcomes\", b, \"POST\"),\n  threads: (contactId?: string) =>\n    req(contactId ? `/threads?contact_id=${encodeURIComponent(contactId)}` : \"/threads\"),\n  threadMessages: (threadId: string) => req(`/threads/${encodeURIComponent(threadId)}/messages`),\n  dashboardSummary: () => req(\"/dashboard/summary\")\n};\n"],"names":[],"mappings":";;;;AAAA;;AACA,MAAM,OACJ,QAAQ,GAAG,CAAC,wBAAwB,IACpC,CAAC,sCAAgC,0BAAS,uBAAuB;AACnE,MAAM,WAAW,CAAC,QAAQ,GAAG,CAAC,oBAAoB,IAAI,OAAO,MAAM;AAEnE,SAAS;IACP;;IAKA,OAAO;AACT;AAEA,MAAM,aAAa;IAAC;IAAW;IAAa;IAAS;IAAe;CAAW;AAE/E,SAAS,SAAS,IAAY;IAC5B,IAAI,mBAAmB,WAAW,IAAI,CAAC,CAAA,IAAK,SAAS,KAAK,KAAK,UAAU,CAAC,GAAG,EAAE,CAAC,CAAC,IAAI;QACnF,OAAO,CAAC,SAAS,EAAE,MAAM;IAC3B;IACA,OAAO,OAAO;AAChB;AAEA,eAAe,IAAI,IAAY,EAAE,IAAU,EAAE,MAAe;IAC1D,MAAM,OAAO,IAAA,sHAAO;IACpB,IAAI;IACJ,IAAI;QACF,MAAM,MAAM,MAAM,SAAS,OAAO;YAChC,QAAQ,UAAU,CAAC,OAAO,SAAS,KAAK;YACxC,SAAS;gBACP,gBAAgB;gBAChB,GAAI,OAAO;oBAAE,eAAe,CAAC,OAAO,EAAE,KAAK,KAAK,EAAE;gBAAC,IAAI,CAAC,CAAC;YAC3D;YACA,MAAM,OAAO,KAAK,SAAS,CAAC,QAAQ;QACtC;IACF,EAAE,OAAO,GAAQ;QACf,MAAM,IAAI,MAAM,oBAAoB,CAAC,GAAG,WAAW,OAAO,EAAE;IAC9D;IAEA,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,OAAO,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,KAAK,EAAE,IAAI,MAAM,EAAE;QAC9D,MAAM,IAAI,MAAM;IAClB;IAEA,IAAI;QACF,OAAO,MAAM,IAAI,IAAI;IACvB,EAAE,OAAO,GAAG;QACV,OAAO;IACT;AACF;AAEO,MAAM,MAAM;IACjB,QAAQ,IAAM,IAAI;IAClB,MAAM,CAAC,IAAW,IAAI,SAAS;IAC/B,YAAY,CAAC,IAAW,IAAI,gBAAgB;IAC5C,aAAa,CAAC,iBACZ,IAAI,CAAC,6BAA6B,EAAE,mBAAmB,iBAAiB;IAC1E,UAAU,IAAM,IAAI;IACpB,UAAU,CAAC,IAAW,IAAI,wBAAwB;IAClD,cAAc,CAAC,IAAW,IAAI,6BAA6B;IAC3D,YAAY,IAAM,IAAI;IACtB,YAAY,CAAC,IAAW,IAAI,YAAY,GAAG;IAC3C,UAAU,IAAM,IAAI;IACpB,eAAe,CAAC,IAAW,IAAI,aAAa,GAAG;IAC/C,eAAe,CAAC,IAAY,IAAW,IAAI,CAAC,UAAU,EAAE,IAAI,EAAE,GAAG;IACjE,eAAe,CAAC,KAAe,IAAI,CAAC,UAAU,EAAE,IAAI,EAAE,WAAW;IACjE,WAAW,CAAC,YACV,IAAI,YAAY,CAAC,sBAAsB,EAAE,mBAAmB,YAAY,GAAG;IAC7E,aAAa,IAAM,IAAI;IACvB,eAAe,CAAC,UAAkB,UAChC,IAAI,wBAAwB;YAAE,WAAW;YAAU;QAAQ,GAAG;IAChE,OAAO,IAAM,IAAI;IACjB,UAAU,CAAC,YACT,IAAI,YAAY,CAAC,qBAAqB,EAAE,mBAAmB,YAAY,GAAG;IAC5E,eAAe,CAAC,IAAW,IAAI,aAAa,GAAG;IAC/C,SAAS,CAAC,YACR,IAAI,YAAY,CAAC,oBAAoB,EAAE,mBAAmB,YAAY,GAAG;IAC3E,gBAAgB,CAAC,WAAqB,IAAI,CAAC,SAAS,EAAE,mBAAmB,UAAU,SAAS,CAAC;IAC7F,kBAAkB,IAAM,IAAI;AAC9B"}},
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///Users/konnerwest/mainst1/mainstai/app/profile/page.tsx"],"sourcesContent":["\"use client\";\nimport { useEffect, useState } from \"react\";\nimport { api } from \"../../lib/api\";\n\ntype Profile = {\n  name: string;\n  services: string;\n  hours: string;\n  serviceArea: string;\n  pricingNotes: string;\n  policies: string;\n  tone: string;\n};\n\nconst emptyProfile: Profile = {\n  name: \"\",\n  services: \"\",\n  hours: \"\",\n  serviceArea: \"\",\n  pricingNotes: \"\",\n  policies: \"\",\n  tone: \"Calm, professional, concise.\"\n};\n\nexport default function ProfilePage() {\n  const [profile, setProfile] = useState<Profile>(emptyProfile);\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    let active = true;\n    async function load() {\n      setLoading(true);\n      setError(null);\n      try {\n        const data = await api.profileGet();\n        if (active && data) setProfile({ ...emptyProfile, ...data });\n      } catch (e: any) {\n        if (active) setError(e?.message || String(e));\n      } finally {\n        if (active) setLoading(false);\n      }\n    }\n    load();\n    return () => {\n      active = false;\n    };\n  }, []);\n\n  async function save() {\n    setSaving(true);\n    setError(null);\n    try {\n      const data = await api.profileSet(profile);\n      setProfile({ ...emptyProfile, ...data });\n    } catch (e: any) {\n      setError(e?.message || String(e));\n    } finally {\n      setSaving(false);\n    }\n  }\n\n  return (\n    <div className=\"stagger\">\n      <div>\n        <span className=\"pill\">Business Context</span>\n        <h2 className=\"section-title\">Business profile</h2>\n        <p className=\"muted\">\n          This is the source of truth for Smart Chat and Owner Cover decisions.\n        </p>\n      </div>\n\n      <div className=\"card\">\n        {loading ? (\n          <div className=\"muted\">Loading...</div>\n        ) : (\n          <>\n            <div className=\"feature-grid\">\n              <div>\n                <label className=\"muted\">Business name</label>\n                <input\n                  className=\"input\"\n                  value={profile.name}\n                  onChange={e => setProfile({ ...profile, name: e.target.value })}\n                />\n              </div>\n              <div>\n                <label className=\"muted\">Hours</label>\n                <input\n                  className=\"input\"\n                  value={profile.hours}\n                  onChange={e => setProfile({ ...profile, hours: e.target.value })}\n                />\n              </div>\n              <div>\n                <label className=\"muted\">Service area</label>\n                <input\n                  className=\"input\"\n                  value={profile.serviceArea}\n                  onChange={e => setProfile({ ...profile, serviceArea: e.target.value })}\n                />\n              </div>\n            </div>\n\n            <div style={{ marginTop: 16 }}>\n              <label className=\"muted\">Services offered</label>\n              <textarea\n                className=\"textarea\"\n                value={profile.services}\n                onChange={e => setProfile({ ...profile, services: e.target.value })}\n              />\n            </div>\n\n            <div className=\"feature-grid\" style={{ marginTop: 16 }}>\n              <div>\n                <label className=\"muted\">Pricing notes</label>\n                <textarea\n                  className=\"textarea\"\n                  value={profile.pricingNotes}\n                  onChange={e => setProfile({ ...profile, pricingNotes: e.target.value })}\n                />\n              </div>\n              <div>\n                <label className=\"muted\">Policies</label>\n                <textarea\n                  className=\"textarea\"\n                  value={profile.policies}\n                  onChange={e => setProfile({ ...profile, policies: e.target.value })}\n                />\n              </div>\n            </div>\n\n            <div style={{ marginTop: 16 }}>\n              <label className=\"muted\">Tone and behavior guidance</label>\n              <textarea\n                className=\"textarea\"\n                value={profile.tone}\n                onChange={e => setProfile({ ...profile, tone: e.target.value })}\n              />\n            </div>\n          </>\n        )}\n\n        {error && <div className=\"muted\">Error: {error}</div>}\n        <div className=\"hero-actions\">\n          <button className=\"btn primary\" disabled={saving} onClick={save}>\n            {saving ? \"Saving...\" : \"Save profile\"}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}